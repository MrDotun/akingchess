<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKING Academy | Lessons</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --green: #064e3b; --gold: #fbbf24; --dark: #022c22; --white: #ffffff; }
        body { font-family: 'Poppins', sans-serif; background: var(--green); color: var(--white); margin: 0; padding-bottom: 50px; }
        
        .container { max-width: 900px; margin: 20px auto; padding: 25px; background: var(--white); color: #333; border-radius: 20px; border: 5px solid var(--gold); box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        h1, h2 { font-family: 'Cinzel'; color: var(--green); text-align: center; margin: 0 0 15px 0; }
        
        /* Nav Panels */
        .panel { background: #f0f0f0; padding: 15px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .btn { padding: 10px 18px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; margin: 5px; transition: 0.3s; font-family: 'Poppins'; }
        .btn-grade { background: var(--dark); color: var(--gold); }
        .btn-lesson { background: #ccc; color: #333; }
        .active { background: var(--gold) !important; color: var(--dark) !important; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

        /* Board Styling */
        .lesson-flex { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; align-items: flex-start; }
        #board { width: 350px; border: 8px solid var(--dark); border-radius: 8px; }
        .instruction-box { flex: 1; min-width: 300px; background: #fffdf0; padding: 20px; border-radius: 12px; border-left: 8px solid var(--green); }

        /* Quiz UI */
        .quiz-card { display: none; background: #f9f9f9; padding: 25px; border-radius: 15px; border: 3px dashed var(--green); margin-top: 20px; }
        .progress-bar { width: 100%; height: 10px; background: #ddd; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--gold); width: 0%; transition: 0.5s; }
        .opt-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #ddd; border-radius: 10px; cursor: pointer; background: white; font-size: 1rem; text-align: left; }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724; font-weight: bold; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }

        .submit-wa { display: none; width: 100%; background: #25D366; color: white; padding: 20px; border: none; border-radius: 10px; font-weight: bold; font-size: 1.3rem; cursor: pointer; box-shadow: 0 4px 0 #128C7E; }
    </style>
</head>
<body>

<div class="container">
    <h1>AKING Academy Lessons</h1>

    <div class="panel">
        <div id="grade-nav">
            <button class="btn btn-grade active" onclick="setGrade(1, this)">Grade 1</button>
            <button class="btn btn-grade" onclick="setGrade(2, this)">Grade 2</button>
            <button class="btn btn-grade" onclick="setGrade(3, this)">Grade 3</button>
            <button class="btn btn-grade" onclick="setGrade(4, this)">Grade 4</button>
            <button class="btn btn-grade" onclick="setGrade(5, this)">Grade 5</button>
            <button class="btn btn-grade" onclick="setGrade(6, this)">Grade 6</button>
        </div>
        <div style="margin-top: 10px;" id="lesson-nav">
            <button class="btn btn-lesson active" onclick="setLesson(1, this)">Lesson 1</button>
            <button class="btn btn-lesson" onclick="setLesson(2, this)">Lesson 2</button>
            <button class="btn btn-lesson" onclick="setLesson(3, this)">Lesson 3</button>
            <button class="btn btn-lesson" onclick="setLesson(4, this)">Lesson 4</button>
            <button class="btn btn-lesson" onclick="setLesson(5, this)">Lesson 5</button>
        </div>
    </div>

    <div id="learning-ui" class="lesson-flex">
        <div id="board"></div>
        <div class="instruction-box">
            <h2 id="lesson-title">Loading...</h2>
            <p id="lesson-text"></p>
            <button class="btn" style="background:var(--green); color:var(--gold); width:100%;" onclick="startQuiz()">Start 5-Question Assignment</button>
        </div>
    </div>

    <div id="quiz-ui" class="quiz-card">
        <div class="progress-bar"><div id="p-fill" class="progress-fill"></div></div>
        <h3 id="q-count">Question 1 of 5</h3>
        <p id="q-text" style="font-size: 1.2rem; font-weight: 600;"></p>
        <div id="options-box"></div>
        <div id="feedback" style="text-align:center; margin-top:15px; font-weight:bold;"></div>
        
        <button id="waBtn" class="submit-wa" onclick="submitToAkan()">
            Send Final Report to Mr. Akan ðŸ“²
        </button>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>

<script>
    let currentGrade = 1;
    let currentLesson = 1;
    let currentQ = 0;
    let totalCorrect = 0;
    let board = null;

    const academyData = {
        "1-1": {
            title: "The King's Walk",
            pos: "4k3/8/8/8/8/8/8/4K3 w - - 0 1",
            text: "The King moves one square in any direction. He is the most important piece!",
            questions: [
                { q: "How many squares can the King move?", a: "1", o: ["1", "2", "5"] },
                { q: "Can the King jump over pieces?", a: "No", o: ["Yes", "No", "Only on Tuesdays"] },
                { q: "Is the King the most important piece?", a: "Yes", o: ["Yes", "No", "Maybe"] },
                { q: "In what direction can the King move?", a: "All directions", o: ["Forward only", "Sideways only", "All directions"] },
                { q: "What happens if the King is lost?", a: "Game Over", o: ["Nothing", "Game Over", "You get a new one"] }
            ]
        },
        "2-1": {
            title: "The Power of Pieces",
            pos: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",
            text: "Every piece has a point value. The Queen is worth 9, Rooks are 5, Bishops/Knights are 3, and Pawns are 1.",
            questions: [
                { q: "How many points is a Rook worth?", a: "5", o: ["3", "5", "9"] },
                { q: "Which piece is worth 9 points?", a: "Queen", o: ["King", "Queen", "Rook"] },
                { q: "If you trade a Bishop (3) for a Pawn (1), is that good?", a: "No", o: ["Yes", "No", "It's equal"] },
                { q: "Which two pieces are both worth 3 points?", a: "Bishop and Knight", o: ["Bishop and Knight", "Rook and Pawn", "Queen and King"] },
                { q: "What is the value of a Pawn?", a: "1", o: ["1", "2", "3"] }
            ]
        },
        "3-1": {
            title: "The Back Rank Mate",
            pos: "6k1/5ppp/8/8/8/8/8/3R2K1 w - - 0 1",
            text: "Look at the Black King! He is trapped behind his own pawns. A Rook or Queen on the back row can end the game!",
            questions: [
                { q: "What is the best move for White to checkmate?", a: "Rd8#", o: ["Rd8#", "Rb1", "Kh1"] },
                { q: "Why can't the Black King escape?", a: "His own pawns block him", o: ["The Rook is too fast", "His own pawns block him", "He is tired"] },
                { q: "Which rank is the 'Back Rank' for Black?", a: "8th Rank", o: ["1st Rank", "8th Rank", "5th Rank"] },
                { q: "Can a Bishop deliver a Back Rank mate alone?", a: "No", o: ["Yes", "No", "Only if it's white"] },
                { q: "What could Black have moved to prevent this?", a: "A pawn to h6", o: ["A pawn to h6", "The King to f8", "Nothing"] }
            ]
        },
        "4-1": {
            title: "The Scholar's Trap",
            pos: "r1bqkbnr/pppp1ppp/2n5/4p2Q/2B1P3/8/PPPP1PPP/RNB1K1NR b KQkq - 0 1",
            text: "Look at the board! The White Queen and Bishop are both attacking f7. This is the Scholar's Mate threat!",
            questions: [
                { q: "Which square is the Queen attacking to win?", a: "f7", o: ["f7", "h7", "e4"] },
                { q: "How many pieces attack f7 in this trap?", a: "2", o: ["1", "2", "3"] },
                { q: "Which black piece usually defends f7?", a: "King", o: ["King", "Queen", "Knight"] },
                { q: "Is Scholar's Mate a quick win?", a: "Yes", o: ["Yes", "No", "It takes 50 moves"] },
                { q: "Should you develop your pieces to defend f7?", a: "Yes", o: ["Yes", "No", "I should ignore it"] }
            ]
        },
        "5-1": {
            title: "The Knight Fork",
            pos: "r3k2r/pppq1ppp/2n5/2b1p1N1/8/2NP4/PPP2PPP/R1BQ1RK1 w kq - 0 1",
            text: "A 'Fork' is when one piece attacks two or more pieces at once. Knights are the masters of the fork!",
            questions: [
                { q: "If the White Knight moves to f7, which two pieces does it attack?", a: "Rook and Queen", o: ["Rook and Queen", "King and Pawn", "Bishop and Knight"] },
                { q: "What is the name of an attack on two pieces at once?", a: "A Fork", o: ["A Pin", "A Fork", "A Skewer"] },
                { q: "Which piece is best at jumping to create forks?", a: "Knight", o: ["Rook", "Knight", "Bishop"] },
                { q: "Can a pawn perform a fork?", a: "Yes", o: ["Yes", "No", "Only after promotion"] },
                { q: "How do you stop a fork?", a: "Move or capture the attacker", o: ["Cry", "Move or capture the attacker", "Ignore it"] }
            ]
        },
        "6-1": {
            title: "Pawn Promotion",
            pos: "8/P7/8/k7/8/8/8/K7 w - - 0 1",
            text: "When a pawn reaches the other side of the board, it can become any piece. Usually, we choose a Queen!",
            questions: [
                { q: "What is the best move for White to win?", a: "a8=Q", o: ["a8=Q", "Ka2", "Kb2"] },
                { q: "Can you have two Queens on the board at once?", a: "Yes", o: ["Yes", "No", "Only in tournaments"] },
                { q: "What is it called when a pawn reaches the 8th rank?", a: "Promotion", o: ["Leveling up", "Promotion", "Evolution"] },
                { q: "Can a pawn promote to a King?", a: "No", o: ["Yes", "No", "Only if your King died"] },
                { q: "Which piece is the most powerful choice for promotion?", a: "Queen", o: ["Knight", "Rook", "Queen"] }
            ]
        }
    };

    function setGrade(g, btn) {
        currentGrade = g;
        $('.btn-grade').removeClass('active');
        $(btn).addClass('active');
        loadLesson();
    }

    function setLesson(l, btn) {
        currentLesson = l;
        $('.btn-lesson').removeClass('active');
        $(btn).addClass('active');
        loadLesson();
    }

    function loadLesson() {
        const key = `${currentGrade}-${currentLesson}`;
        const data = academyData[key] || { 
            title: "Coming Soon", 
            pos: "start", 
            text: "Mr. Akan is setting up the pieces for this advanced lesson. Please check back soon!",
            questions: Array(5).fill({q: "Are you ready for the future?", a: "Yes", o: ["Yes", "No", "Wait"]})
        };

        $('#lesson-title').text(`Grade ${currentGrade}: ${data.title}`);
        $('#lesson-text').text(data.text);
        $('#learning-ui').show();
        $('#quiz-ui').hide();

        if (board) board.destroy();
        board = Chessboard('board', {
            position: data.pos,
            showNotation: true,
            pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png'
        });
    }

    function startQuiz() {
        currentQ = 0;
        totalCorrect = 0;
        $('#learning-ui').hide();
        $('#quiz-ui').show();
        showQuestion();
    }

    function showQuestion() {
        const key = `${currentGrade}-${currentLesson}`;
        const data = academyData[key] || academyData["1-1"];
        const qData = data.questions[currentQ];
        
        $('#q-count').text(`Question ${currentQ + 1} of 5`);
        $('#p-fill').css('width', `${(currentQ / 5) * 100}%`);
        $('#q-text').text(qData.q);
        $('#feedback').text("");
        
        const shuffled = [...qData.o].sort(() => Math.random() - 0.5);
        $('#options-box').empty();
        
        shuffled.forEach(opt => {
            const b = $('<button class="opt-btn"></button>').text(opt);
            b.click(function() {
                $('.opt-btn').off('click');
                if (opt === qData.a) {
                    $(this).addClass('correct');
                    totalCorrect++;
                    $('#feedback').text("Correct! âœ…");
                } else {
                    $(this).addClass('wrong');
                    $('#feedback').text("Wrong! âŒ The answer was: " + qData.a);
                }
                
                setTimeout(() => {
                    currentQ++;
                    if (currentQ < 5) {
                        showQuestion();
                    } else {
                        finishQuiz();
                    }
                }, 1500);
            });
            $('#options-box').append(b);
        });
    }

    function finishQuiz() {
        $('#p-fill').css('width', '100%');
        $('#q-text').text("Assignment Complete!");
        $('#options-box').empty();
        $('#feedback').html(`<h2>Final Score: ${totalCorrect}/5</h2>`);
        $('#waBtn').show();
    }

    function submitToAkan() {
        const name = prompt("Enter Student's Full Name:");
        if (!name) return;
        const msg = `AKING ACADEMY REPORT%0A-------------------%0AStudent: ${name}%0AGrade: ${currentGrade}%0ALesson: ${currentLesson}%0AScore: ${totalCorrect}/5%0A-------------------%0AExcellent work!`;
        window.open(`https://wa.me/2348108020946?text=${msg}`);
    }

    $(document).ready(loadLesson);
</script>

</body>
</html>
